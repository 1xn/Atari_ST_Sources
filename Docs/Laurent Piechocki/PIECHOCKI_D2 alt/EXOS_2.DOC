
                           ππππππππππππππππππππππ
                           EXERCICES NR¯2 SUR LES
     
                               FONCTIONS DU
                              
                            GEMDOS,BIOS et XBIOS

                           ππππππππππππππππππππππ



 VoilÖ des exercices qui vont vous obliger (enfin!) Ö PROGRAMMER avec
 votre assembleur.
 Pensez Ö utiliser les macros instructions que nous avons crÇes dans
 le chapitre prÇcÇdent et qui se trouvent dans le fichier :MACROS.L
 Ces exercices ont pour but de vous familliariser avec les fonctions
 du GEMDOS,BIOS et XBIOS ainsi qu'avec les instructions du 68000.

 Bon courage.

 Les corrigÇs sont prÇsents dans le fichier :CORRIG_2.DOC
                                             ππππππππππππ

  

1) Exercice nr¯1:
   πππππππππππππ

   êcrivez une MACRO instruction dont le but est de sauvegarder les 
   registres de donnÇe et d'adresse sur le pile systäme et nommez la
   'SAUVE'.

   êcrivez la MACRO instruction complÇmentaire qui va recharger les
   registres de donnÇe et d'adresse avec les valeurs empilÇes par la
   macro 'SAUVE'.Vous nommerez cette macro: 'RESTORE'.

   Ceux qui n'y arriveront pas au bout de 10 secondes n'ont pas lus 
   correctement le cours sur les instructions du 68000 ...


2) Exercice nr¯2:
   ππππππππππππππ
   CrÇez une MACRO instruction Ö 1 paramätre dont le but est d'afficher
   en HEXADêCIMAL le contenu du paramätre (Long-Mot).
   Nommez cette macro instruction :'HEXA'

   Indications:
   ππππππππππππ
   .Un chiffre HEXA est reprÇsentÇ par 4 bits
   .Servez vous des instructions de rotation ou de dÇcalage pour 
    atteindre tous les bits du paramätre dont vous aurrez besoin.
   .Pour garder un nombre dÇfini de BITS dans un registre, on masque
    les bits Ö garder avec l'instruction AND. 
    (Par exp. AND #%111,dn masque les bits 0,1 et 2 de dn) 
   .Le code ascii de '0' est $30
   .Le code ascii de 'A' est $37+$A
   
   
3) Exercice nr¯3:
   ππππππππππππππ
   CrÇez une MACRO instruction Ö 1 paramätre dont le but est d'afficher
   en BINAIRE le contenu du paramätre (Long-Mot).
   Nommez cette macro instruction :'BINAIRE'

   Indications:
   ππππππππππππ
   .Utilisez les instructions de dÇcalage et de rotation ainsi que les
    instructions de branchements conditionnels appropriÇes.


4) Exercice nr¯4:
   ππππππππππππππ 
   CrÇez un programme dont le but est de FORMATER la disquette
   (80 pistes,9 secteurs par piste,interleave=1)

   Le programme affichera un message d'alerte et demandera une 
   confirmation avant le formatage.

   En cas d'erreur, il faudra que le programme affiche le code de
   l'erreur en DêCIMAL.


   Indications:
   ππππππππππππ

   .Utilisez la fonction FLOPFMT du GEMDOS
   .Certains paramätres devront varier... (nr¯ de piste)
   .Pour afficher un nombre en DêCIMAL, pensez Ö utiliser l'instruction
    DIVU (apräs avoir changÇ le signe du nombre Ö traiter car il est nÇ-
    gatif!) pour rechercher le chiffre des dixaines,le chiffre des uni-
    tÇs.(si vous n'y arrivez pas en dÇcimal utilisez alors votre macro
    BINAIRE ou HEXA)
   .Le code ascii de 0 est $30
   .RÇservez beaucoup de mÇmoire avec SETBLOCK (en 'PILE'):au moins 20000
    octets...( La taille du PRG ne sera pas influencÇe de toute maniäre,
    alors ne soyez pas radin sur vos 512 KO de RAM...)
   .L'adresse du TAMPON pour FLOPFMT devra ätre PAIRE, ne l'oubliez pas!


5) Exercice nr¯5:
   ππππππππππππππ

  CrÇez un programme qui permet de jouer les sons qui sont dÇfinits dans
  le fichier PROSOUND.DAT (que vous intÇgrerez Ö la fin de votre listing
  dans le segment DATA).
  Les touches de FONCTION (F1 Ö F10) serviront de clavier et si on appuye
  sur une autre touche, le prg devra s'arràter.


  Indications:

  .Pensez Ö chercher les SCANCODEs des touches de fonction.
   Comme vous ne les connaissez pas encore il faudra faire un petit prg
   qui vous les affiches. (Ultra simple, utilisez la macro HEXA et affi-
   chez le code de retour de 'WAIT' par exp:il vous suffira d'enfoncer
   les touches de fonction pour que leur scancode apparaisse..)
  .Rejouez les sons avec la macro DOSOUND (Gemdos)
  .RÇservez beaucoup de mÇmoire pour SETBLOCK (en 'PILE')  



6) Exercice nr¯6:
   ππππππππππππππ

   CrÇez un programme qui affiche le directory de la disquette.

   Indications:

   .Utilisez les fonctions SEARCH et SEARCH_NEXT du Gemdos.
   .Le tampon DTA doit ätre situÇ Ö une adresse PAIRE, ne l'oubliez pas!
   .RÇservez beaucoup de place pour SETBLOCK (en 'PILE')   


   
                         ππππππππππππππππππππ

 Je conáois que ces exercices peuvent vous poser certains problämes, si
 vous ne progressez pas, regardez le listings correspondant Ö l'exercice
 que vous n'arrivez pas Ö faire et essayez de le reÇcrire.

 Ne regardez le corrigÇ qu'en dernier lieu...


 
 PIECHOCKI  Laurent
 8,impasse Bellevue            CORRECTIONS dans le fichier:CORRIG_2.DOC
 57980 TENTELING                                           ππππππππππππ 



     

