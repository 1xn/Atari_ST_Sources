/*----------------------------------------------------------------------------------------	TOSAllocator.h, TOS allocator (Mxalloc ...)	20.7.2001 by Manfred Lippert, mani@mani.de	last change: 20.7.2001----------------------------------------------------------------------------------------*/#include <TOSAllocator.h>#include <SysInfo.h>TOSAllocator::TOSAllocator(int16 mode) {	set_mode(mode);}int16 TOSAllocator::set_mode(int16 mode) {	return (this->mode = (mode & sysinfo.Mxmask));}void *TOSAllocator::allocate(size_t bytes) {	void *addr;	if (!sysinfo.Mxalloc || (addr = Mxalloc((int32)bytes, mode)) == (void *)EINVFN) {		addr = Malloc(bytes);	}	return addr;}void TOSAllocator::deallocate(void *addr) {	Mfree(addr);}void *TOSAllocator::reallocate(void *addr, size_t bytes) {	if (bytes == 0) {		deallocate(addr);		return 0;	}	if (Mshrink(0, addr, (int32)bytes) == E_OK) {		return addr;	}	return 0;}