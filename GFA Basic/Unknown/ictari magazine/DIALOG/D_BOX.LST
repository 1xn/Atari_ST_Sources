'
' ******************************************************************************
'
'                          Your programme goes here.
'                          -------------------------
GOSUB your_programme
'
> PROCEDURE your_programme
  '
  LOCAL sn&
  '
  DEFTEXT 1,0,0,13
  '
  GOSUB d1
  '
  GOSUB count
  GOSUB dca
  '
  GOSUB edit
  GOSUB dca
  '
  sn&=18
  GOSUB dbs(sn&)
  GOSUB select
  GOSUB dca
  '
  GOSUB yes_no
  GOSUB dca
  '
  GOSUB dz
  '
RETURN
'
'                       \\ Count box.
> PROCEDURE count
  '
  DIM xy&(6)
  '
  xy&(1)=50
  '              \* Instruction box length. *\ ???
  xy&(2)=190
  '
  xy&(3)=20
  xy&(4)=50
  '              \* Instruction box text. *\ ???
  '
  box$(1)="Enter number."
  '
  '
  xy&(5)=70
  '              \* Instruction box text position. *\ ???
  xy&(6)=36
  '              \* Count box label. *\ ???
  '
  box$(4)="Number = "
  '
  '              \* Box type, 1 = count box. *\
  box&(3)=1
  '              \* Maximum count box number. *\ ???
  box%(1)=100
  '
  DEFMOUSE 0
  SHOWM
  '
  GOSUB d2
  '
  ERASE xy&()
  '
  HIDEM
  '
RETURN
'                       \\ Edit box.
> PROCEDURE edit
  '
  DIM xy&(7)
  '
  xy&(1)=50
  '              \* Instruction box length. *\ ???
  xy&(2)=180
  '
  xy&(3)=20
  xy&(4)=50
  '              \* Instruction box text. *\ ???
  '
  box$(1)="Enter text."
  '
  '              \* Instruction box text position. *\ ???
  xy&(5)=70
  xy&(6)=36
  '              \* Box type, 2 = edit box. *\
  box&(3)=2
  '
  DEFMOUSE 0
  SHOWM
  '
  GOSUB d2
  '
  ERASE xy&()
  '
  HIDEM
  '
RETURN
'                       \\ Select box.
> PROCEDURE select
  '
  DIM xy&(7)
  '              \* Instruction box size. *\ ???
  xy&(1)=50
  xy&(2)=175
  '
  xy&(3)=20
  xy&(4)=50
  '              \* Instruction box text. *\ ???
  '
  box$(1)="Select box."
  '
  '              \* Instruction box text position. *\ ???
  '
  xy&(5)=70
  xy&(6)=36
  '              \* Box type, 3 = select box. *\ ???
  box&(3)=3
  '              \* Number of boxes that can be drawn. *\ ???
  box&(1)=24
  '              \* Only one box selectable. *\ ???
  box&(2)=TRUE
  '                            \\ Arrays.
  '                            ----------
  '
  '                            \\ Dimension Arrays.
  '
  '                            \\ Selection box x1 position.
  DIM s_x_1&(box&(1))
  '                            \\ Selection box x2 position.
  DIM s_x_2&(box&(1))
  '                            \\ Selection box y1 position.
  DIM s_y_1&(box&(1))
  '                            \\ Selection box y2 position.
  DIM s_y_2&(box&(1))
  '                            \\ Selection box TEXT.
  DIM s_1$(box&(1))
  '                            \\ Selection box TEXT position.
  DIM st_x&(box&(1))
  '                            \\ Selection box TEXT position.
  DIM st_y&(box&(1))
  '                            \\ Selection box information.
  '                            -----------------------------
  ' \\ BOX number 1.
  ' ----------------
  '
  s_x_1&(1)=35
  '
  s_x_2&(1)=105
  '
  s_y_1&(1)=78
  '
  s_y_2&(1)=92
  '
  s_1$(1)="1"
  '
  st_x&(1)=66
  '
  st_y&(1)=88
  '
  ' \\ BOX number 2.
  ' ----------------
  '
  s_x_1&(2)=135
  '
  s_x_2&(2)=205
  '
  s_y_1&(2)=78
  '
  s_y_2&(2)=92
  '
  s_1$(2)="2"
  '
  st_x&(2)=166
  '
  st_y&(2)=88
  '
  ' \\ BOX number 3.
  ' ----------------
  '
  s_x_1&(3)=235
  '
  s_x_2&(3)=305
  '
  s_y_1&(3)=78
  '
  s_y_2&(3)=92
  '
  s_1$(3)="3"
  '
  st_x&(3)=266
  '
  st_y&(3)=88
  '
  ' \\ BOX number 4.
  ' ----------------
  '
  s_x_1&(4)=335
  '
  s_x_2&(4)=405
  '
  s_y_1&(4)=78
  '
  s_y_2&(4)=92
  '
  s_1$(4)="4"
  '
  st_x&(4)=366
  '
  st_y&(4)=88
  '
  ' \\ BOX number 5.
  ' ----------------
  '
  s_x_1&(5)=435
  '
  s_x_2&(5)=505
  '
  s_y_1&(5)=78
  '
  s_y_2&(5)=92
  '
  s_1$(5)="5"
  '
  st_x&(5)=466
  '
  st_y&(5)=88
  '
  ' \\ BOX number 6.
  ' ----------------
  '
  s_x_1&(6)=535
  '
  s_x_2&(6)=605
  '
  s_y_1&(6)=78
  '
  s_y_2&(6)=92
  '
  s_1$(6)="6"
  '
  st_x&(6)=568
  '
  st_y&(6)=88
  '
  ' \\ BOX number 7.
  ' ----------------
  '
  s_x_1&(7)=35
  '
  s_x_2&(7)=105
  '
  s_y_1&(7)=100
  '
  s_y_2&(7)=114
  '
  s_1$(7)="7"
  '
  st_x&(7)=66
  '
  st_y&(7)=110
  '
  ' \\ BOX number 8.
  ' ----------------
  '
  s_x_1&(8)=135
  '
  s_x_2&(8)=205
  '
  s_y_1&(8)=100
  '
  s_y_2&(8)=114
  '
  s_1$(8)="8"
  '
  st_x&(8)=166
  '
  st_y&(8)=110
  '
  ' \\ BOX number 9.
  ' ----------------
  '
  s_x_1&(9)=235
  '
  s_x_2&(9)=305
  '
  s_y_1&(9)=100
  '
  s_y_2&(9)=114
  '
  s_1$(9)="9"
  '
  st_x&(9)=266
  '
  st_y&(9)=110
  '
  ' \\ BOX number 10.
  ' ----------------
  '
  s_x_1&(10)=335
  '
  s_x_2&(10)=405
  '
  s_y_1&(10)=100
  '
  s_y_2&(10)=114
  '
  s_1$(10)="A"
  '
  st_x&(10)=366
  '
  st_y&(10)=110
  '
  ' \\ BOX number 11.
  ' ----------------
  '
  s_x_1&(11)=435
  '
  s_x_2&(11)=505
  '
  s_y_1&(11)=100
  '
  s_y_2&(11)=114
  '
  s_1$(11)="B"
  '
  st_x&(11)=466
  '
  st_y&(11)=110
  '
  ' \\ BOX number 12.
  ' ----------------
  '
  s_x_1&(12)=535
  '
  s_x_2&(12)=605
  '
  s_y_1&(12)=100
  '
  s_y_2&(12)=114
  '
  s_1$(12)="C"
  '
  st_x&(12)=566
  '
  st_y&(12)=110
  '
  ' \\ BOX number 13.
  ' ----------------
  '
  s_x_1&(13)=35
  '
  s_x_2&(13)=105
  '
  s_y_1&(13)=122
  '
  s_y_2&(13)=136
  '
  s_1$(13)="D"
  '
  st_x&(13)=66
  '
  st_y&(13)=132
  '
  ' \\ BOX number 14.
  ' ----------------
  '
  s_x_1&(14)=135
  '
  s_x_2&(14)=205
  '
  s_y_1&(14)=122
  '
  s_y_2&(14)=136
  '
  s_1$(14)="E"
  '
  st_x&(14)=166
  '
  st_y&(14)=132
  '
  ' \\ BOX number 15.
  ' ----------------
  '
  s_x_1&(15)=235
  '
  s_x_2&(15)=305
  '
  s_y_1&(15)=122
  '
  s_y_2&(15)=136
  '
  s_1$(15)="F"
  '
  st_x&(15)=266
  '
  st_y&(15)=132
  '
  ' \\ BOX number 16.
  ' ----------------
  '
  s_x_1&(16)=335
  '
  s_x_2&(16)=405
  '
  s_y_1&(16)=122
  '
  s_y_2&(16)=136
  '
  s_1$(16)="G"
  '
  st_x&(16)=366
  '
  st_y&(16)=132
  '
  ' \\ BOX number 17.
  ' ----------------
  '
  s_x_1&(17)=435
  '
  s_x_2&(17)=505
  '
  s_y_1&(17)=122
  '
  s_y_2&(17)=136
  '
  s_1$(17)="H"
  '
  st_x&(17)=460
  '
  st_y&(17)=132
  '
  ' \\ BOX number 18.
  ' ----------------
  '
  s_x_1&(18)=535
  '
  s_x_2&(18)=605
  '
  s_y_1&(18)=122
  '
  s_y_2&(18)=136
  '
  s_1$(18)="J"
  '
  st_x&(18)=566
  '
  st_y&(18)=132
  '
  DEFMOUSE 0
  SHOWM
  '
  GOSUB d2
  '
  ERASE s_x_1&(),s_x_2&(),s_y_1&(),s_y_2&(),s_1$(),st_x&(),st_y&()
  '
  ERASE xy&()
  '
  HIDEM
  '
RETURN
'                       \\ Yes No box.
> PROCEDURE yes_no
  '
  DIM xy&(7)
  '
  xy&(1)=50
  '              \* Instruction box length. *\ ???
  xy&(2)=210
  '
  xy&(3)=20
  xy&(4)=50
  '              \* Instruction box text. *\ ???
  '
  box$(1)="Do you want to?"
  '
  xy&(5)=70
  '              \* Instruction box text position. *\ ???
  xy&(6)=36
  '              \* Box type, 4 = yes or no box. *\
  box&(3)=4
  '              \* Default setting = YES. *\ ???
  box&(4)=TRUE
  '
  DEFMOUSE 0
  SHOWM
  '
  GOSUB d2
  '
  ERASE xy&()
  '
  HIDEM
  '
RETURN
'
' ******************************************************************************
'
' \\ Main dialogue box programme. \\
' **********************************
'
'                       \\ Get machine information.
> PROCEDURE d1
  '
  '                     \\ Dimension arrays for dialogue boxes.
  DIM sn&(25,1)
  DIM box&(4)
  DIM box%(3)
  DIM box$(4)
  '                     \\ resolution% =
  box%(3)=XBIOS(4)
  '
RETURN
'                       \\ Maximum boxes = 18.
> PROCEDURE dbs(sn&)
  '
  IF sn&>1 OR sn&=1
    '
    sn&(1,1)=TRUE
  ELSE
    '
    sn&(1,1)=FALSE
  ENDIF
  '
  IF sn&>2 OR sn&=2
    '
    sn&(2,1)=TRUE
  ELSE
    '
    sn&(21,1)=FALSE
  ENDIF
  '
  IF sn&>3 OR sn&=3
    '
    sn&(3,1)=TRUE
  ELSE
    '
    sn&(3,1)=FALSE
  ENDIF
  '
  IF sn&>4 OR sn&=4
    '
    sn&(4,1)=TRUE
  ELSE
    '
    sn&(4,1)=FALSE
  ENDIF
  '
  IF sn&>5 OR sn&=5
    '
    sn&(5,1)=TRUE
  ELSE
    '
    sn&(5,1)=FALSE
  ENDIF
  '
  IF sn&>6 OR sn&=6
    '
    sn&(6,1)=TRUE
  ELSE
    '
    sn&(6,1)=FALSE
  ENDIF
  '
  IF sn&>7 OR sn&=7
    '
    sn&(7,1)=TRUE
  ELSE
    '
    sn&(7,1)=FALSE
  ENDIF
  '
  IF sn&>8 OR sn&=8
    '
    sn&(8,1)=TRUE
  ELSE
    '
    sn&(8,1)=FALSE
  ENDIF
  '
  IF sn&>9 OR sn&=9
    '
    sn&(9,1)=TRUE
  ELSE
    '
    sn&(9,1)=FALSE
  ENDIF
  '
  IF sn&>10 OR sn&=10
    '
    sn&(10,1)=TRUE
  ELSE
    '
    sn&(10,1)=FALSE
  ENDIF
  '
  IF sn&>11 OR sn&=11
    '
    sn&(11,1)=TRUE
  ELSE
    '
    sn&(11,1)=FALSE
  ENDIF
  '
  IF sn&>12 OR sn&=12
    '
    sn&(12,1)=TRUE
  ELSE
    '
    sn&(12,1)=FALSE
  ENDIF
  '
  IF sn&>13 OR sn&=13
    '
    sn&(13,1)=TRUE
  ELSE
    '
    sn&(13,1)=FALSE
  ENDIF
  '
  IF sn&>14 OR sn&=14
    '
    sn&(14,1)=TRUE
  ELSE
    '
    sn&(14,1)=FALSE
  ENDIF
  '
  IF sn&>15 OR sn&=15
    '
    sn&(15,1)=TRUE
  ELSE
    '
    sn&(15,1)=FALSE
  ENDIF
  '
  IF sn&>16 OR sn&=16
    '
    sn&(16,1)=TRUE
  ELSE
    '
    sn&(16,1)=FALSE
  ENDIF
  '
  IF sn&>17 OR sn&=17
    '
    sn&(17,1)=TRUE
  ELSE
    '
    sn&(17,1)=FALSE
  ENDIF
  '
  IF sn&>18 OR sn&=18
    '
    sn&(18,1)=TRUE
  ELSE
    '
    sn&(18,1)=FALSE
  ENDIF
  '
RETURN
'                       \\ Clear dialogue box arrays.
> PROCEDURE dca
  '
  ERASE sn&()
  ERASE box&()
  ERASE box$()
  '
  DIM sn&(25,1)
  DIM box&(4)
  DIM box$(4)
  '
  box%(0)=0
  box%(1)=0
  box%(2)=0
  '
RETURN
'                       \\ Erase arrays.
> PROCEDURE dz
  '
  ERASE sn&()
  ERASE box&()
  ERASE box%()
  ERASE box$()
  '
RETURN
'                       \\ Dialogue box. \\
'                       *******************
> PROCEDURE d2
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ add_character& = ac&
  '
  ' \\ number_of_characters| = nc&
  '
  LOCAL ac&,nc&
  '                            \\ Draw box.
  GOSUB d3(ac&,nc&)
  '                            \\ Monitor dialogue box operation.
  GOSUB d4(ac&,nc&)
  '
RETURN
'                       \\ Draw box.
'
> PROCEDURE d3(VAR ac&,nc&)
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ box_count& = bc&
  '
  LOCAL bc&
  '                            \\ Draw main box
  GOSUB dm
  '                            \\ Draw return box.
  GOSUB dr1
  '                            \\ Draw instructions box.
  GOSUB di
  '
  '                            \\ IF count_box
  IF box&(3)=1
    '                          \\ Draw counting box.
    GOSUB dc
  ENDIF
  '                            \\ IF edit_box
  IF box&(3)=2
    '                          \\ number_of_characters& = LEN(name$)
    nc&=LEN(box$(2))
    '                          \\ IF number_of_characters& > 0
    IF nc&>0
      '                        \\ add_character& = TRUE
      ac&=TRUE
      '
      GOSUB de(ac&,k$,l_1c&,l_2c&,nc&)
      '
    ENDIF
  ENDIF
  '                            \\ IF selection_box
  IF box&(3)=3
    '                          \\ box_count& = number_of_selection_boxes&
    bc&=box&(1)
    '                          \\ number_of_selection_boxes& = 0
    box&(1)=0
    '
    REPEAT
      '                        \\ number_of_selection_boxes& = box&(1) + 1
      box&(1)=box&(1)+1
      '                        \\ SELECT resolution%
      SELECT box%(3)
        '                      \\ Low resolution.
      CASE 0
        '                      \\ High resolution.
      CASE 2
        '
        s_y_1&(box&(1))=s_y_1&(box&(1))*2
        s_y_2&(box&(1))=s_y_2&(box&(1))*2
        '
        st_y&(box&(1))=st_y&(box&(1))*2
      ENDSELECT
      '
      IF sn&(box&(1),1)=TRUE
        '                        \\ Draw selection box.
        GOSUB ds1
      ENDIF
      '                        \\ UNTIL number_of_selection_boxes| = box_counbox&(3)
    UNTIL box&(1)=bc&
  ENDIF
  '                            \\ IF yes_or_no_box
  IF box&(3)=4
    '                          \\ Draw and redraw YES box.
    GOSUB dy
    '                          \\ Draw and redraw NO box.
    GOSUB dn
  ENDIF
  '                            \\ Date and Time box.
  GOSUB dt
  '
RETURN
'
'                       \\ Draw main box
> PROCEDURE dm
  '                            \\ Main box.
  '
  '                            \\ SELECT resolution%(2)
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    DEFFILL 3,1
    PBOX 0,0,319,199
    '
  CASE 1
    '                          \\ Medium resolution.
    DEFFILL 3,1
    PBOX 0,0,639,199
    '
  CASE 2
    '                          \\ High resolution.
    DEFFILL 0,1
    PBOX 0,0,639,399
  ENDSELECT
  '
RETURN
'                       \\ Draw RETURN box.
> PROCEDURE dr1
  '
  '                            \\ SELECT resolution%
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    DEFFILL 0,1
    PBOX 200,160,260,175
    '                          \\ Return box outline.
    LINE 200,160,260,160
    LINE 200,175,260,175
    LINE 200,160,200,175
    LINE 260,160,260,175
    '                          \\ Return box text.
    TEXT 206,170,0,"Return"
    '
  CASE 1
    '                          \\ Medium resolution.
    DEFFILL 0,1
    PBOX 460,160,560,175
    '                          \\ Return box outline.
    LINE 460,160,560,160
    LINE 460,175,560,175
    LINE 460,160,460,175
    LINE 560,160,560,175
    '                           \\ Return box text.
    TEXT 480,170,0," Return"
    '
  CASE 2
    '                           \\ High resolution.
    DEFFILL 0,1
    '                          \\ Return box outline.
    LINE 460,320,560,320
    LINE 460,350,560,350
    LINE 460,320,460,350
    LINE 560,320,560,350
    '                           \\ Return box text.
    TEXT 480,340,0," Return"
    '
  ENDSELECT
  '
RETURN
'                       \\ Redraw RETURN box.
> PROCEDURE dr2
  '
  '                            \\ SELECT resolution.
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    DEFFILL 2,1
    PBOX 200,160,260,175
    '                          \\ Return box outline.
    LINE 200,160,260,160
    LINE 200,175,260,175
    LINE 200,160,200,175
    LINE 260,160,260,175
    '                           \\ Return box text.
    TEXT 206,170,0,"Return"
    '
  CASE 1
    '                          \\ Medium resolution.
    DEFFILL 2,1
    PBOX 460,160,560,175
    '                          \\ Return box outline.
    LINE 460,160,560,160
    LINE 460,175,560,175
    LINE 460,160,460,175
    LINE 560,160,560,175
    '                          \\ Return box text.
    TEXT 480,170,0," Return"
    '
  CASE 2
    '                          \\ High resolution.
    DEFFILL 1,1
    PBOX 460,320,560,350
    '                          \\ Return box outline.
    LINE 460,320,560,320
    LINE 460,350,560,350
    LINE 460,320,460,350
    LINE 560,320,560,350
    '                           \\ Return box text.
    TEXT 480,340,0," Return"
    '
  ENDSELECT
  '
RETURN
'                       \\ Draw instructions box.
> PROCEDURE di
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ length_of_string& = l&
  '
  ' \\ length_of_string_2& = l_2&
  '
  ' \\ place& = p&
  '
  LOCAL l&,l_2&,p&
  '
  ' ----------------------------------string$-----------------------------------
  '
  ' \\ byte$ = b$
  '
  ' \\ line_1$ = l_1$
  '
  ' \\ line_2$ = l_2$
  '
  LOCAL b$,l_1$,l_2$
  '                            \\ SELECT resolution.
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ length_of_string& = LEN(instructions_1$)
    l&=LEN(box$(1))
    '                          \\ place& = 32
    p&=32
    '                          \\ IF length_of_string& > 32
    IF l&>32
      '
      DO
        '                      \\ byte$ = MID$(instructions_1$,place&,1)
        b$=MID$(box$(1),p&,1)
        '                      \\ IF byte$ = SPACE
        IF b$=CHR$(32)
          '                    \\ instructions_2$ = MID$(instructions_1$,place&+1,length_of_string&-place&)
          '
          l_2$=MID$(box$(1),p&+1,l&-p|)
          '
          '                    \\ instructions_1$ = LEFT$(instructions_1$,place&)
          '
          l_1$=LEFT$(box$(1),p&)
        ELSE
          '                    \\ place& = place& - 1
          p&=p&-1
        ENDIF
        '                      \\ EXIT IF byte$ = SPACE
        EXIT IF b$=CHR$(32)
      LOOP
      '
      xy&(1)=20
      '                        \\ length_of_string_2& = LEN(line_1$)
      l_2&=LEN(l_1$)
      '
      xy&(2)=l_2&*8+40
      '
      xy&(5)=30
      '
      xy&(6)=32
    ELSE
      '
      xy&(1)=20
      '
      xy&(2)=l&*8+40
      '
      xy&(5)=30
    ENDIF
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    xy&(3)=xy&(3)*2
    xy&(4)=xy&(4)*2
    '
    xy&(6)=xy&(6)*2
  ENDSELECT
  '
  DEFFILL 0,1
  PBOX xy&(1),xy&(3),xy&(2),xy&(4)
  '
  '                            \\ Instructions box outline.
  '
  LINE xy&(1),xy&(3),xy&(2),xy&(3)
  LINE xy&(1),xy&(4),xy&(2),xy&(4)
  LINE xy&(1),xy&(3),xy&(1),xy&(4)
  LINE xy&(2),xy&(3),xy&(2),xy&(4)
  '
  IF l&<32
    '                            \\ Instructions box text.
    TEXT xy&(5),xy&(6),0,box$(1)
  ELSE
    '                            \\ Instructions box text.
    PRINT AT(5,4);l_1$
    '
    PRINT AT(5,6);l_2$
  ENDIF
  '
RETURN
'                       \\ Draw and redraw Yes box.
> PROCEDURE dy
  '
  '                            \\ IF yes& = FALSE
  IF box&(4)=FALSE
    '
    DEFFILL 0,1
  ENDIF
  '                            \\ IF yes& = 1 AND low OR med resolution
  '
  IF box&(4)=TRUE AND box%(3)<2
    '
    DEFFILL 2,1
  ENDIF
  '                            \\ IF yes& = TRUE AND high resolution.
  IF box&(4)=TRUE AND box%(3)=2
    '
    DEFFILL 1,1
  ENDIF
  '                            \\ SELECT resolution%(2)
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ YES box.
    PBOX 70,95,120,115
    '                          \\ YES box outline.
    LINE 70,95,120,95
    LINE 70,115,120,115
    LINE 70,95,70,115
    LINE 120,95,120,115
    '                          \\ Text YES box.
    TEXT 84,108,0,"Yes"
    '
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    '
    '                          \\ YES box.
    PBOX 140,95,240,115
    '                          \\ YES box outline.
    LINE 140,95,240,95
    LINE 140,115,240,115
    LINE 140,95,140,115
    LINE 240,95,240,115
    '                          \\ Text YES box.
    TEXT 179,108,0,"Yes"
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    '
    '                          \\ YES box.
    PBOX 140,190,240,230
    '                          \\ YES box outline.
    LINE 140,190,240,190
    LINE 140,230,240,230
    LINE 140,190,140,230
    LINE 240,190,240,230
    '                          \\ Text YES box.
    TEXT 179,216,0,"Yes"
    '
  ENDSELECT
  '
RETURN
'                       \\ Draw and redraw No box.
> PROCEDURE dn
  '
  '                            \\ IF yes& = FALSE AND low OR med resolution
  '
  IF box&(4)=FALSE AND box%(3)<2
    '
    DEFFILL 2,1
  ENDIF
  '                            \\ IF yes = FALSE AND high resolution
  '
  IF box&(4)=FALSE AND box%(3)=2
    '
    DEFFILL 1,1
  ENDIF
  '                            \\ IF yes& = TRUE
  IF box&(4)=TRUE
    '
    DEFFILL 0,1
  ENDIF
  '                            \\ SELECT resolution%(2)
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ NO box.
    PBOX 200,95,250,115
    '                          \\ NO box outline.
    LINE 200,95,250,95
    LINE 200,115,250,115
    LINE 200,95,200,115
    LINE 250,95,250,115
    '                          \\ Text NO box.
    TEXT 217,108,0,"No"
    '
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    '
    '                          \\ NO box.
    PBOX 400,95,500,115
    '                          \\ NO box outline.
    LINE 400,95,500,95
    LINE 400,115,500,115
    LINE 400,95,400,115
    LINE 500,95,500,115
    '                          \\ Text NO box.
    TEXT 441,108,0,"No"
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    '
    '                          \\ NO box.
    PBOX 400,190,500,230
    '                          \\ NO box outline.
    LINE 400,190,500,190
    LINE 400,230,500,230
    LINE 400,190,400,230
    LINE 500,190,500,230
    '                          \\ Text NO box.
    TEXT 441,216,0,"No"
    '
  ENDSELECT
  '
RETURN
'                       \\ Draw selection boxes WHITE.
> PROCEDURE ds1
  '
  '                            \\ SELECT resolution.
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    IF s_x_1&<319 AND s_x_2&<319
      '
      DEFFILL 0,1
      PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      '
      '                          \\ Selection box outline.
      '
      LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
      LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
      LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      '
      TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
      '
    ENDIF
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    DEFFILL 0,1
    PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    '                          \\ Selection box outline.
    '
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
    LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
    LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    '
    DEFFILL 0,1
    PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    '                          \\ Selection box outline.
    '
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
    LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
    LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
    '
  ENDSELECT
  '
RETURN
'                       \\ Draw selection boxes RED.
> PROCEDURE ds2
  '
  '                            \\ SELECT resolution.
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    IF s_x_1&(box&(1))<319 AND s_x_2&(box&(1))<319
      '
      DEFFILL 2,1
      PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      '
      '                          \\ Selection box outline.
      '
      LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
      LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
      LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
      '
      TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
      '
    ENDIF
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    '
    DEFFILL 2,1
    PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    '                          \\ Selection box outline.
    '
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
    LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
    LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    DEFFILL 1,1
    PBOX s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    '                          \\ Selection box outline.
    '
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_1&(box&(1))
    LINE s_x_1&(box&(1)),s_y_2&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    LINE s_x_1&(box&(1)),s_y_1&(box&(1)),s_x_1&(box&(1)),s_y_2&(box&(1))
    LINE s_x_2&(box&(1)),s_y_1&(box&(1)),s_x_2&(box&(1)),s_y_2&(box&(1))
    '
    TEXT st_x&(box&(1)),st_y&(box&(1)),0,s_1$(box&(1))
    '
  ENDSELECT
  '
RETURN
'                       \\ Draw counting box outline.
> PROCEDURE dc
  '
  '                            \\ SELECT resolution.
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ Draw counting box.
    DEFFILL 0,1
    PBOX 53,90,267,110
    '                          \\ Outline counting box.
    LINE 53,90,267,90
    LINE 53,110,267,110
    LINE 53,90,53,110
    LINE 267,90,267,110
    '
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    '
    '                          \\ Draw counting box.
    DEFFILL 0,1
    PBOX 200,90,414,110
    '                          \\ Outline counting box.
    LINE 200,90,414,90
    LINE 200,110,414,110
    LINE 200,90,200,110
    LINE 414,90,414,110
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    '
    '                          \\ Draw counting box.
    DEFFILL 0,1
    PBOX 200,180,414,220
    '                          \\ Outline counting box.
    LINE 200,180,414,180
    LINE 200,220,414,220
    LINE 200,180,200,220
    LINE 414,180,414,220
  ENDSELECT
  '                            \\ number_of_items% counting box.
  GOSUB dc1
  '
RETURN
'                       \\ Draw and redraw counting box number.
> PROCEDURE dc1
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ length& = l&
  '
  LOCAL l&
  '                            \\ Low resolution.
  IF box%(3)=0
    '
    PRINT AT(8,13);box$(4)
  ENDIF
  '                            \\ Medium OR high resolution.
  IF box%(3)=1 OR box%(3)=2
    '
    PRINT AT(27,13);box$(4)
  ENDIF
  '                            \\ length& = LEN(number_of_items$)
  l&=LEN(box$(3))
  '
  SELECT l&
    '
  CASE 0
    '
    IF box%(3)=0 AND box%(2)=0
      '
      PRINT AT(23,13);"         0"
    ENDIF
    '
    IF box%(3)=1 AND box%(2)=0 OR box%(3)=2 AND box%(2)=0
      '
      PRINT AT(41,13);"         0"
    ENDIF
    '
  CASE 1
    '
    IF box%(2)>0
      '
      IF box%(3)=0
        '
        PRINT AT(23,13);"         ";box$(3)
      ENDIF
      '
      IF box%(3)=1 OR box%(3)=2
        '
        PRINT AT(41,13);"         ";box$(3)
      ENDIF
    ENDIF
    '
  CASE 2
    '
    IF box%(3)=0
      '
      PRINT AT(28,13);"        ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"        ";box$(3)
    ENDIF
    '
  CASE 3
    '
    IF box%(3)=0
      '
      PRINT AT(28,13);"       ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"       ";box$(3)
    ENDIF
    '
  CASE 4
    '
    IF box%(3)=0
      '
      PRINT AT(28,13);"      ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"      ";box$(3)
    ENDIF
    '
  CASE 5
    '
    IF box%(3)=0
      '
      PRINT AT(21,13);"     ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"     ";box$(3)
    ENDIF
    '
  CASE 6
    '
    IF box%(3)=0
      '
      PRINT AT(27,13);"    ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"    ";box$(3)
    ENDIF
    '
  CASE 7
    '
    IF box%(3)=0
      '
      PRINT AT(26,13);"   ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"   ";box$(3)
    ENDIF
    '
  CASE 8
    '
    IF box%(3)=0
      '
      PRINT AT(25,13);"  ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);"  ";box$(3)
    ENDIF
    '
  CASE 9
    '
    IF box%(3)=0
      '
      PRINT AT(24,13);" ";box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);" ";box$(3)
    ENDIF
    '
  CASE 10
    '
    IF box%(3)=0
      '
      PRINT AT(23,13);box$(3)
    ENDIF
    '
    IF box%(3)=1 OR box%(3)=2
      '
      PRINT AT(41,13);box$(3)
    ENDIF
    '
  ENDSELECT
  '
RETURN
'                       \\ number_of_items& counting box.
> PROCEDURE dc2(k$)
  '
  SELECT k$
    '                          \\ Multiply number_of_items| by 10.
    '                          -----------------------------------
  CASE "K"
    '                          \\ number_of_items% = number_of_items% X 10
    box%(2)=box%(2)*10
    '                          \\ IF number_of_items% > maximum_number_of_items%
    IF box%(2)>box%(1)
      '                        \\ number_of_items% = maximum_number_of_items%
      box%(2)=box%(1)
    ENDIF
    '                          \\ Increase number_of_items| by 1.
    '                          ----------------------------------
  CASE "H"
    '                          \\ IF number_of_items% < maximum_number_of_items%
    IF box%(2)<box%(1)
      '                        \\ number_of_items% = number_of_items% + 1
      box%(2)=box%(2)+1
    ELSE
      box%(2)=0
      '                        \\ Draw and redraw counting box.
      GOSUB dc1
    ENDIF
    '                          \\ Divide number_of_items| by 10.
    '                          ---------------------------------
  CASE "M"
    '                          \\ number_of_items% = number_of_items% / 10
    box%(2)=box%(2)/10
    '                          \\ Ensure number_of_items% is an integer.
    box%(2)=TRUNC(box%(2))
    '                          \\ Decrease number_of_or_is| by 1.
    '                          ----------------------------------
  CASE "P"
    '                          \\ IF number_of_items% = 0
    IF box%(2)=0
      '                        \\ number_of_items% = maximum_number%
      box%(2)=box%(1)
    ENDIF
    '                          \\ number_of_items% = number_of_items% - 1
    box%(2)=box%(2)-1
  ENDSELECT
  '                            \\ number_of_items$ = STR$(number_of_items%)
  box$(3)=STR$(box%(2))
RETURN
'                       \\ Date and Time box.
> PROCEDURE dt
  '                            \\ SELECT resolution%
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    DEFFILL 0,1
    PBOX 8,180,92,194
    '                          \\ Time box outline.
    LINE 8,180,92,180
    LINE 8,194,92,194
    LINE 8,180,8,194
    LINE 92,180,92,194
    '                           \\ Time box text.
    PRINT AT(3,24);TIME$
    '
  CASE 1
    '                          \\ Medium resolution.
    DEFFILL 0,1
    PBOX 28,180,104,194
    '                          \\ Time box outline.
    LINE 28,180,104,180
    LINE 28,194,104,194
    LINE 28,180,28,194
    LINE 104,180,104,194
    '                          \\ Time box text.
    '
    PRINT AT(5,24);TIME$
  CASE 2
    '                          \\ High resolution.
    '
    '                          \\ Time box outline.
    LINE 28,364,104,364
    LINE 28,388,104,388
    LINE 28,364,28,388
    LINE 104,364,104,388
    '                          \\ Time box text.
    PRINT AT(5,24);TIME$
  ENDSELECT
  '
RETURN
'                       \\ Monitor dialogue box operation. \\
'                       *************************************
'
> PROCEDURE d4(VAR ac&,nc&)
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ box_count& = bc&
  '
  ' \\ box_selected& = bs&
  '
  ' \\ button& = b&
  '
  ' \\ finish& = f&
  '
  ' \\ key& = k&
  '
  ' \\ length& = l&
  '
  ' \\ line_1_completed& = l_1c&
  '
  ' \\ line_2_completed& = l_2c&
  '
  ' \\ return& = r&
  '
  ' \\ x&
  '
  ' \\ y&
  '
  LOCAL bc&,bs&,b&,f&,k&,l&,l_1c&,l_2c&,r&,x&,y&
  '
  ' ---------------------------------string$------------------------------------
  '
  ' \\ key$ = k$
  '
  ' \\ time$ = t$
  '
  LOCAL k$,t$
  '
  DO
    ' \\ Update TIME$ \\
    ' ******************
    '
    '                          \\ IF time$ NOT = TIME$
    IF t$<>TIME$
      '                        \\ time$ = TIME$
      t$=TIME$
      '                        \\ SELECT resolution.
      SELECT box%(3)
        '                      \\ Low resolution.
      CASE 0
        '
        PRINT AT(3,24);TIME$
        '                      \\ Medium and High resolution.
      CASE 1,2
        '
        PRINT AT(5,24);TIME$
      ENDSELECT
      '
      SHOWM
    ENDIF
    '
    ' \\ Keyboard. \\
    ' ***************
    '                          \\ key$ = INKEY$
    k$=INKEY$
    '                          \\ length& = LEN(key$)
    l&=LEN(k$)
    '                          \\ IF length& = 1
    IF l&=1
      '                        \\ Convert to ASCI codes.
      k&=ASC(k$)
      '                        \\ SELECT key&
      SELECT k&
        '                      \\ Backspace.
      CASE 8
        '                      \\ IF box&(3) = edit_box
        IF box&(3)=2
          '                    \\ add_character& = FALSE
          ac&=FALSE
          '
          GOSUB de(ac&,k$,l_1c&,l_2c&,nc&)
        ENDIF
        '                      \\ Characters for edit box.
      CASE 32 TO 125
        '
        ' \\ Keyboard Edit box. \\
        ' ************************
        '
        '                      \\ IF edit_box
        IF box&(3)=2
          '                    \\ Selects addition of character to name.
          '
          '                    \\ add_character& = TRUE
          ac&=TRUE
          '
          GOSUB de(ac&,k$,l_1c&,l_2c&,nc&)
        ENDIF
        '
        ' \\ Keyboard Select box. \\
        ' **************************
        '
        '                      \\ IF select box
        IF box&(3)=3
          '                    \\ box_count& = number_of_selection_boxes&
          bc&=box&(1)
          '                    \\ number_of_selection_boxes& = 0
          box&(1)=0
          '                    \\ key$=UPPER$(key$)
          k$=UPPER$(k$)
          '
          REPEAT
            '                  \\ number_of_selection_boxes& = box&(1) + 1
            box&(1)=box&(1)+1
            '
            IF k$=LEFT$(s_1$(box&(1))) AND sn&(box&(1),1)=TRUE
              '
              '                \\ IF only_one_item_selectable& = FALSE
              '
              IF box&(2)=FALSE
                '
                '              \\ box_selected& = 0
                bs&=0
                '              \\ IF selected_number&(number_of_selection_box&) = TRUE
                '
                IF sn&(box&(1),0)=TRUE
                  '
                  '            \\ selected_number&(number_of_selection_box&) = FALSE
                  '
                  sn&(box&(1),0)=FALSE
                  '
                  GOSUB ds1
                ELSE
                  '            \\ selected_number|(number_of_selection_box&) = TRUE
                  '
                  sn&(box&(1),0)=TRUE
                  '
                  GOSUB ds2
                ENDIF
                '
              ELSE
                '              \\ box_selected& = number_of_selection_boxes&
                bs&=box&(1)
              ENDIF
            ENDIF
            '
          UNTIL box&(1)=bc&
          '                    \\ IF box_selected| > 0
          IF bs&>0
            '                  \\ box_count& = number_of_selection_boxes&
            bc&=box&(1)
            '                  \\ number_of_selection_boxes& = 0
            box&(1)=0
            '
            REPEAT
              '                \\ number_of_selection_boxes& = box&(1) + 1
              '
              box&(1)=box&(1)+1
              '
              '                \\ IF number_of_selection_boxes& = box_selected&
              '
              IF box&(1)=bs& AND sn&(box&(1),1)=TRUE
                '
                '              \\ selected_number&(number_of_selection_box&) = TRUE
                '
                sn&(box&(1),0)=TRUE
                '
                GOSUB ds2
              ELSE
                '
                IF sn&(box&(1),1)=TRUE
                  '
                  '            \\ selected_number&(number_of_selection_box&) = FALSE
                  '
                  sn&(box&(1),0)=FALSE
                  '
                  GOSUB ds1
                ENDIF
              ENDIF
              '
            UNTIL box&(1)=bc&
          ENDIF
        ENDIF
        '
        ' \\ Keyboard Yes or No box.\\
        ' *****************************
        '
        '                      \\ IF yes_no_box
        IF box&(3)=4
          '                    \\ IF key& = Y OR key$ = y
          IF k$="Y" OR k$="y"
            '                  \\ yes& = TRUE
            box&(4)=TRUE
            '                  \\ Redraw YES box.
            GOSUB dy
            '                  \\ Redraw NO box.
            GOSUB dn
          ENDIF
          '                    \\ IF key$ = N OR key$ = n
          IF k$="N" OR k$="n"
            '                  \\ yes& = FALSE
            box&(4)=FALSE
            '                  \\ Redraw YES box.
            GOSUB dy
            '                  \\ Redraw NO box.
            GOSUB dn
          ENDIF
        ENDIF
      ENDSELECT
      '
      ' \\ Keyboard Return key. \\
      ' **************************
      '
      '                        \\ IF k$ = CHR$(13)
      IF k$=CHR$(13)
        '                      \\ IF count_box
        IF box&(3)=1
          '                    \\ Check number_of_items% has been entered.
          IF box%(2)>0
            '                  \\ Redraw RETURN box.
            GOSUB dr2
            '                  \\ finish& = TRUE
            f&=TRUE
          ELSE
            '                  \\ ZERO number_of_items& entered.
            k$=""
          ENDIF
        ENDIF
        '                      \\ IF edit_box
        IF box&(3)=2
          '                    \\ IF number_of_characters& > 0
          IF nc&>0
            '                  \\ Redraw RETURN box.
            GOSUB dr2
            '                  \\ finish& = TRUE
            f&=TRUE
          ELSE
            '                  \\ ZERO number_of_characters| entered.
            k$=""
          ENDIF
        ENDIF
        '                      \\ IF selection_box
        IF box&(3)=3
          '                    \\ Redraw return box.
          GOSUB dr2
          '                    \\ finish& = TRUE
          f&=TRUE
        ENDIF
        '                      \\ IF yes_or_no_box
        IF box&(3)=4
          '                    \\ Redraw return box.
          GOSUB dr2
          '                    \\ finish& = TRUE
          f&=TRUE
        ENDIF
      ENDIF
    ENDIF
    '                          \\ EXIT IF finish& = TRUE
    EXIT IF f&=TRUE
    '
    ' \\ Keyboard Scan-codes.\\
    ' *************************
    '
    '                          \\ IF length& = 2
    IF l&=2
      '                        \\ key$ = RIGHT$ (key$)
      k$=RIGHT$(k$)
      '                        \\ IF key$ = UNDO
      IF k$="a"
        '                      \\ Remove right hand character.
        '
        '                      \\ IF Edit box.
        IF box&(3)=2
          '                    \\ add_character& = FALSE
          ac&=FALSE
          '
          GOSUB de(ac&,k$,l_1c&,l_2c&,nc&)
        ENDIF
      ENDIF
      '                        \\ IF Count box.
      IF box&(3)=1
        '                      \\ Cursor UP, DOWN, RIGHT, LEFT.
        '                      --------------------------------
        '
        '                      \\ IF k$ = "H"
        '                      \\ Increase number_of_items| by 1.
        '
        '                      \\ IF k$ = "P"
        '                      \\ Decrease number_of_items| by 1.
        '
        '                      \\ IF k$ = "K"
        '                      \\ Multiply number_of_items| by 10.
        '
        '                      \\ IF k$ = "M"
        '                      \\ Divide number_of_items| by 10.
        '
        IF k$="H" OR k$="P" OR k$="K" OR k$="M"
          '
          '                    \\ Number_of_items& counting box.
          GOSUB dc2(k$)
          '                    \\ Draw and redraw count.
          GOSUB dc1
        ENDIF
      ENDIF
    ENDIF
    '
    ' \\ Mouse input. \\
    ' ******************
    '
    MOUSE x&,y&,b&
    '                          \\ If left mouse button pressed.
    '                          \\ check mouse X and Y positions.
    IF b&=1
      '
      ' \\ Mouse Select box. \\
      ' ***********************
      '
      '                        \\ IF Select box
      IF box&(3)=3
        '                      \\ box_count& = number_of_selection_boxes&
        bc&=box&(1)
        '                      \\ number_of_selection_boxes& = 0
        box&(1)=0
        '
        REPEAT
          '                    \\ number_of_selection_boxes| = box&(1) + 1
          box&(1)=box&(1)+1
          '
          IF x&>s_x_1&(box&(1)) AND x&<s_x_2&(box&(1)) AND y&>s_y_1&(box&(1)) AND y&<s_y_2&(box&(1))
            '
            '                  \\ IF only_one_item_selectable& = FALSE
            IF box&(2)=FALSE
              '                \\ box_selected& = 0
              bs&=0
              '                \\ IF selected_number&(number_of_selection_box&) = TRUE
              '
              IF sn&(box&(1),0)=TRUE AND sn&(box&(1),1)=TRUE
                '
                '              \\ selected_number&(number_of_selection_box&) = FALSE
                '
                sn&(box&(1),0)=FALSE
                '
                GOSUB ds1
              ELSE
                '
                IF sn&(box&(1),1)=TRUE
                  '
                  '            \\ selected_number&(number_of_selection_box&) = TRUE
                  '
                  sn&(box&(1),0)=TRUE
                  '
                  GOSUB ds2
                  '
                ENDIF
              ENDIF
              '
            ELSE
              '                \\ box_selected| = number_of_selection_boxes|
              bs&=box&(1)
            ENDIF
          ENDIF
          '
        UNTIL box&(1)=bc&
        '                      \\ IF box_selected& > 0
        IF bs&>0
          '                    \\ box_count& = number_of_selection_boxes|
          bc&=box&(1)
          '                    \\ number_of_selection_boxes| = 0
          box&(1)=0
          '
          REPEAT
            '                  \\ number_of_selection_boxes& = box&(1) + 1
            box&(1)=box&(1)+1
            '                  \\ IF number_of_selection_boxes& = box_selected&
            '
            IF box&(1)=bs& AND sn&(box&(1),1)=TRUE
              '
              '                \\ selected_number&(number_of_selection_box&) = TRUE
              '
              sn&(box&(1),0)=TRUE
              '
              GOSUB ds2
            ELSE
              '
              IF sn&(box&(1),1)=TRUE
                '
                '              \\ selected_number&(number_of_selection_box&) = FALSE
                '
                sn&(box&(1),0)=FALSE
                '
                GOSUB ds1
              ENDIF
            ENDIF
            '
          UNTIL box&(1)=bc&
        ENDIF
      ENDIF
      '
      ' \\ Mouse Yes or No box. \\
      ' **************************
      '
      '                        \\ IF yes_or_no_box
      IF box&(3)=4
        '                      \\ SELECT resolutiobox%(2)
        SELECT box%(3)
          '
        CASE 0
          '                    \\ Low resolution.
          '                    ------------------
          '
          '                    \\ Check for YES.
          IF x&>70 AND x&<120
            IF y&>95 AND y&<115
              '
              '                \\ yes& = TRUE
              box&(4)=TRUE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '                    \\ Check for NO.
          IF x&>200 AND x&<250
            IF y&>95 AND y&<115
              '
              '                \\ yes& = FALSE
              box&(4)=FALSE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '
        CASE 1
          '                    \\ Medium resolution.
          '                    ---------------------
          '
          '                    \\ Check for YES.
          IF x&>140 AND x&<240
            IF y&>95 AND y&<115
              '
              '                \\ yes& = TRUE
              box&(4)=TRUE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '                    \\ Check for NO.
          IF x&>400 AND x&<500
            IF y&>95 AND y&<115
              '
              '                \\ yes& = FALSE
              box&(4)=FALSE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '
        CASE 2
          '                    \\ High resolution.
          '                    -------------------
          '
          '                    \\ Check for YES.
          IF x&>140 AND x&<240
            IF y&>190 AND y&<230
              '
              '                \\ yes& = TRUE
              box&(4)=TRUE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '                    \\ Check for NO.
          IF x&>400 AND x&<500
            IF y&>190 AND y&<230
              '
              '                \\ yes& = FALSE
              box&(4)=FALSE
              '                \\ Redraw YES box.
              GOSUB dy
              '                \\ Redraw NO box.
              GOSUB dn
            ENDIF
          ENDIF
          '
        ENDSELECT
      ENDIF
      '
      ' \\ Mouse Return box. \\
      ' ***********************
      '
      '                        \\ Check for Return box.
      '                        ------------------------
      '
      '                        \\ SELECT resolution
      SELECT box%(3)
        '
      CASE 0
        '                      \\ Low resolution.
        '                      ------------------
        '
        IF x&>200 AND x&<260
          IF y&>160 AND y&<175
            '
            IF box&(3)=1
              '                \\ Check number_of_items% has been entered.
              IF box%(2)>0
                '              \\ Redraw return box.
                GOSUB dr2
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF edit_box
            IF box&(3)=2
              '                \\ IF number of characters > 0
              IF nc&>0
                '              \\ Redraw return box.
                GOSUB dr2
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF select box OR yes or no box
            '
            IF box&(3)=3 OR box&(3)=4
              '
              '                \\ Redraw return box.
              GOSUB dr2
              '                \\ finish& = TRUE
              f&=TRUE
            ENDIF
          ENDIF
        ENDIF
        '
      CASE 1
        '                      \\ Medium resolution.
        '                      ---------------------
        '
        IF x&>460 AND x&<560
          IF y&>160 AND y&<175
            '
            IF box&(3)=1
              '                \\ Check number has been entered.
              IF box%(2)>0
                '              \\ Redraw return box.
                '
                GOSUB dr2
                '
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF edit_box
            IF box&(3)=2
              '                \\ IF number_of_characters& > 0
              IF nc&>0
                '              \\ Redraw return box.
                GOSUB dr2
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF selection_box OR yes_or_no_box
            '
            IF box&(3)=3 OR box&(3)=4
              '
              '                \\ Redraw return box.
              GOSUB dr2
              '                \\ finish& = TRUE
              f&=TRUE
            ENDIF
          ENDIF
        ENDIF
        '
      CASE 2
        '                      \\ High resolution.
        '                      -------------------
        '
        IF x&>460 AND x&<560
          IF y&>320 AND y&<350
            '
            IF box&(3)=1
              '                \\ Check number_of_items% has been entered.
              IF box%(2)>0
                '              \\ Redraw return box.
                '
                GOSUB dr2
                '
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF edit_box
            IF box&(3)=2
              '                \\ IF number_of_characters& > 0
              IF nc&>0
                '              \\ Redraw return box.
                GOSUB dr2
                '              \\ finish& = TRUE
                f&=TRUE
              ELSE
                '              \\ ZERO number_of_characters| entered.
                k$=""
              ENDIF
            ENDIF
            '                  \\ IF selection_box OR yes_or_no_box
            '
            IF box&(3)=3 OR box&(3)=4
              '
              '                \\ Redraw return box.
              GOSUB dr2
              '                \\ finish& = TRUE
              f&=TRUE
            ENDIF
          ENDIF
        ENDIF
      ENDSELECT
      '
    ENDIF
    '                          \\ EXIT IF finish& = TRUE
    EXIT IF f&=TRUE
  LOOP
  '
RETURN
'
'                        \\ Edit box. \\
'                        ***************
'
> PROCEDURE de(ac&,k$,VAR l_1c&,l_2c&,nc&)
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ line_1_length& = l_1&
  '
  ' \\ line_2_length& = l_2&
  '
  ' \\ line_3_length& = l_3&
  '
  ' \\ maximum_length& = ml&
  '
  ' \\ x_1_position& x_1&
  '
  ' \\ x_2_position& x_2&
  '
  ' \\ x_3_position& x_3&
  '
  ' \\ x_4_position& x_4&
  '
  ' \\ x_5_position& x_5&
  '
  ' \\ x_6_position& x_6&
  '
  ' \\ y_1_position& y_1&
  '
  ' \\ y_2_position& y_2&
  '
  ' \\ y_3_position& y_3&
  '
  ' \\ y_4_position& y_4&
  '
  ' \\ y_5_position& y_5&
  '
  ' \\ y_6_position& y_6&
  '
  LOCAL l_1&,l_2&,l_3&,ml&,x_1&,x_2&,x_3&,x_4&,x_5&,x_6&,y_1&,y_2&,y_3&,y_4&,y_5&,y_6&
  '
  ' ----------------------------------string$-----------------------------------
  '
  ' \\ name_1$ = n_1$
  '
  ' \\ name_2$ = n_2$
  '
  ' \\ name_3$ = n_3$
  '
  ' \\ string$ = s$
  '
  LOCAL n_1$,n_2$,n_3$,s$
  '                            \\ IF resolution% = 0
  IF box%(3)=0
    '                          \\ Low resolution.
    '                          ------------------
    ml&=36
  ELSE
    '                          \\ Medium and High resolution.
    '                          ------------------------------
    ml&=72
  ENDIF
  '                            \\ IF add_character& = FALSE
  IF ac&=FALSE
    '                          \\ Remove right hand character.
    '
    GOSUB de1(nc&)
  ENDIF
  '                            \\ IF add_character& = TRUE
  IF ac&=TRUE
    '                          \\ Create INDEX item name.
    '
    GOSUB de2(k$,nc&)
  ENDIF
  '                            \\ IF number_of_characters& > 0 AND < maximum_length& * 3 + 1
  IF nc&>0 AND nc&<ml&*3+1
    '                          \\ string$ = name$
    s$=box$(2)
    '                          \\ Form lines of text.
    '
    GOSUB dl(nc&,ml&,s$,l_1&,l_2&,l_3&,n_1$,n_2$,n_3$)
    '
    '                          \\ Calculate X and Y coordinates, line number 1.
    '
    GOSUB dxy_1(l_1&,x_1&,x_2&,y_1&,y_2&)
    '
    '                          \\ Calculate X and Y coordinates, line number 2.
    '
    GOSUB dxy_2(l_2&,x_3&,x_4&,y_3&,y_4&)
    '
    '                          \\ Calculate X and Y coordinates, line number 3.
    '
    GOSUB dxy_3(l_3&,x_5&,x_6&,y_5&,y_6&)
    '
  ENDIF
  '
  '                            \\ Reset title box to green.
  '
  GOSUB dg(nc&,l_1c&,l_2c&,x_1&,x_3&,x_5&,y_2&,y_4&,y_6&)
  '
  '                            \\ Draw edit box.
  '
  GOSUB deb(nc&,n_1$,n_2$,n_3$,l_1c&,l_2c&,x_1&,x_2&,x_3&,x_4&,x_5&,x_6&,y_1&,y_2&,y_3&,y_4&,y_5&,y_6&)
  '
  '                            \\ IF line 1 and 2 > 0
  IF n_1$>"" AND n_2$>""
    '                          \\ line_1_completed& = 1
    l_1c&=1
  ELSE
    '                          \\ line_1_completed& = 0
    l_1c&=0
  ENDIF
  '                            \\ IF line 2 and 3 > 0
  IF n_2$>"" AND n_3$>""
    '                          \\ line_2_completed& = 1
    l_2c&=1
  ELSE
    '                          \\ line_2_completed| = 0
    l_2c&=0
  ENDIF
  '
RETURN
'
'                       \\ Remove right hand character.
'
> PROCEDURE de1(VAR nc&)
  '
  '                            \\ IF number_of_characters| > 0
  IF nc&>0
    '                          \\ number_of_characters| = number_of_characters| - 1
    DEC nc&
  ENDIF
  '                            \\ name$ = LEFT$(name$,number_of_characters|)
  box$(2)=LEFT$(box$(2),nc&)
  '
RETURN
'
'                       \\ Create INDEX item name.
'
> PROCEDURE de2(k$,VAR nc&)
  '
  '                           \\ Maximum number of characters = 216.
  IF nc&<216
    '                         \\ name$ = name$ + key$
    box$(2)=box$(2)+k$
    '                         \\ number_of_characters| = number_of_characters| + 1
    INC nc&
  ENDIF
  '
RETURN
'
'                       \\ Form lines of text.
'
> PROCEDURE dl(nc&,ml&,VAR s$,l_1&,l_2&,l_3&,n_1$,n_2$,n_3$)
  '
  ' -----------------------------------word&------------------------------------
  '
  ' \\ place& = p&
  '
  LOCAL p&
  '
  ' ----------------------------------string$-----------------------------------
  '
  ' \\ word$ = w$
  '
  LOCAL w$
  '                            \\ place& = 0
  p&=0
  '                            \\ IF number_of_characters& < maximum_length& + 1
  IF nc&<ml&+1
    '                          \\ name_1$ = string$
    n_1$=s$
    '                          \\ name_2$ = ""
    n_2$=""
    '
  ELSE
    '
    DO
      '                        \\ Make a word.
      '
      GOSUB word(nc&,s$,p&,w$)
      '
      '                        \\ IF place& < maximum_length& + 1
      IF p&<ml&+1
        '                      \\ Make line number 1.
        '
        GOSUB dl_1(n_1$,w$)
        '
      ELSE
        '                      \\ IF place& < maximum_length& * 2 + 1
        IF p&<ml&*2+1
          '                    \\ Make line number 2.
          '
          GOSUB dl_2(n_2$,w$)
          '
          '                    \\ name_3$ = ""
          n_3$=""
        ELSE
          '                    \\ Make line number 3.
          '
          GOSUB dl_3(n_3$,w$)
          '
        ENDIF
      ENDIF
      '                        \\ EXIT IF place& = number_of_characters&
      EXIT IF p&=nc&
    LOOP
  ENDIF
  '                            \\ line_1_length& = LEN(name_1$)
  l_1&=LEN(n_1$)
  '                            \\ line_2_length& = LEN(name_2$)
  l_2&=LEN(n_2$)
  '                            \\ line_3_length& = LEN(name_3$)
  l_3&=LEN(n_3$)
  '
RETURN
'
'                       \\ Make a word.
'
> PROCEDURE word(nc&,s$,VAR p&,w$)
  '
  ' ----------------------------------string$-----------------------------------
  '
  ' \\ byte$ = b$
  '
  LOCAL b$
  '
  REPEAT
    '                          \\ place& = place& + 1
    p&=p&+1
    '                          \\ byte$ = MID$(string$,place&,1)
    b$=MID$(s$,p&,1)
    '                          \\ word$ = word$ + byte$
    w$=w$+b$
    '                          \\ UNTIL byte$ = " " OR p& = number_of_characters&
    '
  UNTIL b$=CHR$(32) OR p&=nc&
  '
RETURN
'
'                       \\ Make line number 1.
'
> PROCEDURE dl_1(VAR n_1$,w$)
  '
  '                            \\ name_1$ = name_1$ + word$
  n_1$=n_1$+w$
  '                            \\ word$ = ""
  w$=""
  '
RETURN
'
'                       \\ Make line number 2.
'
> PROCEDURE dl_2(VAR n_2$,w$)
  '
  '                            \\ name_2$ = name_2$ + word$
  n_2$=n_2$+w$
  '                            \\ word$ = ""
  w$=""
  '
RETURN
'
'                       \\ Make line number 3.
'
> PROCEDURE dl_3(VAR n_3$,w$)
  '
  '                            \\ name_3$ = name_3$ + word$
  n_3$=n_3$+w$
  '                            \\ word$ = ""
  w$=""
  '
RETURN
'
'                       \\ Calculate X and Y coordinates, one number 1.
'
> PROCEDURE dxy_1(l_1&,VAR x_1&,x_2&,y_1&,y_2&)
  '
  '                            \\ IF line_1_length& > 0
  IF l_1&>0
    '                          \\ ATARI ST.
    '                          ------------
    '
    '                          \\ SELECT resolution%
    SELECT box%(3)
      '
    CASE 0
      '                        \\ Low resolution.
      '                        ------------------
      '
      '                        \\ X position 1.
      x_1&=(319-l_1&*8)/2
      '                        \\ X position 2.
      x_2&=x_1&+(l_1&*8)
      '                        \\ clears TEXT.
      x_1&=x_1&-16
      x_2&=x_2&+16
      '                        \\ Y position 1.
      y_1&=80
      '                        \\ Y position 2.
      y_2&=95
      '
    CASE 1
      '                        \\ Medium resolution.
      '                        ---------------------
      '
      '                        \\ X position 1.
      x_1&=(639-l_1&*8)/2
      '                        \\ X position 2.
      x_2&=x_1&+(l_1&*8)
      '                        \\ clears TEXT.
      x_1&=x_1&-16
      x_2&=x_2&+16
      '                        \\ Y position 1.
      y_1&=80
      '                        \\ Y position 2.
      y_2&=95
      '
    CASE 2
      '                        \\ High resolution.
      '                        -------------------
      '
      '                        \\ X position 1.
      x_1&=(639-l_1&*8)/2
      '                        \\ X position 2.
      x_2&=x_1&+(l_1&*8)
      '                        \\ clears TEXT.
      x_1&=x_1&-16
      x_2&=x_2&+16
      '                        \\ Y position 1.
      y_1&=160
      '                        \\ Y position 2.
      y_2&=180
      '
    ENDSELECT
  ELSE
    '
    x_1&=0
    x_2&=0
    '
    y_1&=0
    y_2&=0
    '
  ENDIF
RETURN
'
'                       \\ Calculate X and Y coordinates, one number 2.
'
> PROCEDURE dxy_2(l_2&,VAR x_3&,x_4&,y_3&,y_4&)
  '
  '                            \\ IF line_2_length& > 0
  IF l_2&>0
    '                          \\ SELECT resolution
    SELECT box%(3)
      '
    CASE 0
      '                        \\ Low resolution.
      '                        ------------------
      '
      '                        \\ X position 3.
      x_3&=(319-l_2&*8)/2
      '                        \\ X position 4.
      x_4&=x_3&+(l_2&*8)
      '                        \\ clears TEXT.
      x_3&=x_3&-16
      x_4&=x_4&+16
      '                        \\ Y position 3.
      y_3&=100
      '                        \\ Y position 4.
      y_4&=115
      '
    CASE 1
      '                        \\ Medium resolution.
      '                        ---------------------
      '
      '                        \\ X position 3.
      x_3&=(639-l_2&*8)/2
      '                        \\ X position 4.
      x_4&=x_3&+(l_2&*8)
      '                        \\ clears TEXT.
      x_3&=x_3&-16
      x_4&=x_4&+16
      '                        \\ Y position 3.
      y_3&=100
      '                        \\ Y position 4.
      y_4&=115
      '
    CASE 2
      '                        \\ High resolution.
      '                        -------------------
      '
      '                        \\ X position 3.
      x_3&=(639-l_2&*8)/2
      '                        \\ X position 4.
      x_4&=x_3&+(l_2&*8)
      '                        \\ clears TEXT.
      x_3&=x_3&-16
      x_4&=x_4&+16
      '                        \\ Y position 3.
      y_3&=200
      '                        \\ Y position 4.
      y_4&=220
      '
    ENDSELECT
  ELSE
    '
    x_3&=0
    x_4&=0
    '
    y_3&=0
    y_4&=0
    '
  ENDIF
  '
RETURN
'
'                       \\ Calculate X and Y coordinates, one number 3.
'
> PROCEDURE dxy_3(l_3&,VAR x_5&,x_6&,y_5&,y_6&)
  '
  '                            \\ IF line_3_length& > 0
  IF l_3&>0
    '                          \\ SELECT resolution%
    SELECT box%(3)
      '
    CASE 0
      '                        \\ Low resolution.
      '                        ------------------
      '
      '                        \\ X position 5.
      x_5&=(319-l_3&*8)/2
      '                        \\ X position 6.
      x_6&=x_5&+(l_3&*8)
      '                        \\ clears TEXT.
      x_5&=x_5&-16
      x_6&=x_6&+16
      '                        \\ Y position 5.
      y_5&=120
      '                        \\ Y position 6.
      y_6&=135
      '
    CASE 1
      '                        \\ Medium resolution.
      '                        ---------------------
      '
      '                        \\ X position 5.
      x_5&=(639-l_3&*8)/2
      '                        \\ X position 6.
      x_6&=x_5&+(l_3&*8)
      '                        \\ clears TEXT.
      x_5&=x_5&-16
      x_6&=x_6&+16
      '                        \\ Y position 5.
      y_5&=120
      '                        \\ Y position 6.
      y_6&=135
      '
    CASE 2
      '                        \\ High resolution.
      '                        -------------------
      '
      '                        \\ X position 5.
      x_5&=(639-l_3&*8)/2
      '                        \\ X position 6.
      x_6&=x_5&+(l_3&*8)
      '                        \\ clears TEXT.
      x_5&=x_5&-16
      x_6&=x_6&+16
      '                        \\ Y position 5.
      y_5&=240
      '                        \\ Y position 6.
      y_6&=260
      '
    ENDSELECT
  ELSE
    '
    x_5&=0
    x_6&=0
    '
    y_5&=0
    y_6&=0
    '
  ENDIF
  '
RETURN
'
'                       \\ Reset title box to green.
'
> PROCEDURE dg(nc&,l_1c&,l_2c&,x_1&,x_3&,x_5&,y_2&,y_4&,y_6&)
  '
  '                            \\ SELECT resolutiobox%(2)
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ IF line_1_completed& = 0
    IF l_1c&=0
      '
      DEFFILL 3,1
      PBOX 0,80,319,95
      '                        \\ Removes old TEXT.
      TEXT x_1&+4,y_2&-5,0,""
    ENDIF
    '                          \\ IF line_2_completed& = 0
    IF l_2c&=0
      DEFFILL 3,1
      PBOX 0,100,319,115
      '                        \\ Removes old TEXT.
      TEXT x_3&+4,y_4&-5,0,""
    ENDIF
    '
    DEFFILL 3,1
    PBOX 0,120,319,135
    '                          \\ Removes old TEXT.
    TEXT x_5&+4,y_6&-5,0,""
    '
  CASE 1
    '                          \\ Medium resolution.
    '                          ---------------------
    '
    '                          \\ IF line_1_completed& = 0
    IF l_1c&=0
      '
      DEFFILL 3,1
      PBOX 0,80,639,95
      '                        \\ Removes old TEXT.
      TEXT x_1&+4,y_2&-5,0,""
    ENDIF
    '                          \\ IF line_2_completed& = 0
    IF l_2c&=0
      '
      DEFFILL 3,1
      PBOX 0,100,639,115
      '                        \\ Removes old TEXT.
      TEXT x_3&+4,y_4&-5,0,""
    ENDIF
    '
    DEFFILL 3,1
    PBOX 0,120,639,135
    '                          \\ Removes old TEXT.
    TEXT x_5&+4,y_6&-5,0,""
    '
  CASE 2
    '                          \\ High resolution.
    '                          -------------------
    '
    '                          \\ IF line_1_completed& = 0
    IF l_1c&=0
      '
      DEFFILL 0,1
      PBOX 0,160,639,190
      '                        \\ Removes old TEXT.
      TEXT x_1&+4,(y_2&-5)*2,0,""
    ENDIF
    '                          \\ IF line_2_completed& = 0
    IF l_2c&=0
      '
      DEFFILL 0,1
      PBOX 0,200,639,230
      '                        \\ Removes old TEXT.
      TEXT x_3&+4,(y_4&-5)*2,0,""
    ENDIF
    '
    DEFFILL 0,1
    PBOX 0,240,639,270
    '                          \\ Removes old TEXT.
    TEXT x_5&+4,(y_6&-5)*2,0,""
    '
  ENDSELECT
  '
RETURN
'
'                       \\ Draw edit box.
'
> PROCEDURE deb(nc&,n_1$,n_2$,n_3$,l_1c&,l_2c&,x_1&,x_2&,x_3&,x_4&,x_5&,x_6&,y_1&,y_2&,y_3&,y_4&,y_5&,y_6&)
  '
  '                            \\ TITLE box.
  '
  '                            \\ IF line_1_completed& = 0
  IF l_1c&=0
    '
    DEFFILL 0,1
    PBOX x_1&,y_1&,x_2&,y_2&
    '                          \\ TITLE box outline.
    LINE x_1&,y_1&,x_2&,y_1&
    LINE x_1&,y_2&,x_2&,y_2&
    LINE x_1&,y_1&,x_1&,y_2&
    LINE x_2&,y_1&,x_2&,y_2&
    '
    TEXT x_1&+16,y_2&-5,0,n_1$
  ENDIF
  '                            \\ SELECT resolution%(2)
  SELECT box%(3)
    '
  CASE 0
    '                          \\ Low resolution.
    '                          ------------------
    '
    '                          \\ IF number_of_characters& >36
    IF nc&>36
      '                        \\ IF line_2_completed& = 0
      IF l_2c&=0
        '
        DEFFILL 0,1
        PBOX x_3&,y_3&,x_4&,y_4&
        '
        '                        \\ TITLE box outline.
        '
        LINE x_3&,y_3&,x_4&,y_3&
        LINE x_3&,y_4&,x_4&,y_4&
        LINE x_3&,y_3&,x_3&,y_4&
        LINE x_4&,y_3&,x_4&,y_4&
        '
        TEXT x_3&+16,y_4&-5,0,n_2$
        '
      ENDIF
    ENDIF
    '                          \\ IF number_of_characters& < 72 AND < 109
    IF nc&>72 AND nc&<109
      '
      DEFFILL 0,1
      PBOX x_5&,y_5&,x_6&,y_6&
      '                        \\ TITLE box outline.
      LINE x_5&,y_5&,x_6&,y_5&
      LINE x_5&,y_6&,x_6&,y_6&
      LINE x_5&,y_5&,x_5&,y_6&
      LINE x_6&,y_5&,x_6&,y_6&
      '
      TEXT x_5&+16,y_6&-5,0,n_3$
      '
    ENDIF
    '
  CASE 1,2
    '                          \\ Medium  and high resolution.
    '                          -------------------------------
    '
    '                          \\ IF number_of_characters& >72
    IF nc&>72
      '                        \\ IF line_2_completed& = 0
      IF l_2c&=0
        '
        DEFFILL 0,1
        PBOX x_3&,y_3&,x_4&,y_4&
        '
        '                        \\ TITLE box outline.
        '
        LINE x_3&,y_3&,x_4&,y_3&
        LINE x_3&,y_4&,x_4&,y_4&
        LINE x_3&,y_3&,x_3&,y_4&
        LINE x_4&,y_3&,x_4&,y_4&
        '
        TEXT x_3&+16,y_4&-5,0,n_2$
        '
      ENDIF
    ENDIF
    '                          \\ IF number_of_characters& < 144 AND <216 OR = 216.
    IF nc&>144 AND nc&<217
      '
      DEFFILL 0,1
      PBOX x_5&,y_5&,x_6&,y_6&
      '                        \\ TITLE box outline.
      LINE x_5&,y_5&,x_6&,y_5&
      LINE x_5&,y_6&,x_6&,y_6&
      LINE x_5&,y_5&,x_5&,y_6&
      LINE x_6&,y_5&,x_6&,y_6&
      '
      TEXT x_5&+16,y_6&-5,0,n_3$
      '
    ENDIF
  ENDSELECT
  '
RETURN
