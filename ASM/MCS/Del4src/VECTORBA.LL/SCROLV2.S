	TEXT

ECRAN	EQU	$70000
	
	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	MOVE.W	#0,-(SP)
	PEA	$70000
	PEA	$70000
	MOVE.W	#5,-(SP)
	TRAP	#$E
	ADD.L	#12,SP

	MOVEM.L	$FF8240,D0-D7
	MOVEM.L	D0-D7,OLD_PAL

	MOVE.W	#$0,$FF8240
	MOVE.W	#$777,$FF8242

*	MOVEM.L	IMG+2,D0-D7
*	MOVEM.L	D0-D7,$FF8240

	LEA	$70000,A0
	MOVEQ	#0,D0
	MOVE.W	#7999,D1
EFF_SCR
	MOVE.L	D0,(A0)+
	DBRA	D1,EFF_SCR

	MOVE.B	#$12,$FFFC02
	
.WAIT
	MOVE.W	#$25,-(SP)
	TRAP	#$E
	ADDQ.L	#2,SP
	
	BSR	SCROLL
	
	CMP.B	#$39,$FFFC02
	BNE.S	.WAIT

	MOVE.B	#$8,$FFFC02
	
	MOVEM.L	OLD_PAL,D0-D7
	MOVEM.L	D0-D7,$FF8240
	
	CLR.L	-(SP)
	TRAP	#1
	
SCROLL
	JSR	ROUT1
	RTS
ROUT1
	MOVE.L	#ROUT2,SCROLL+2
ROUT1B
PEKM
	MOVE.L	#MESS,A0
	MOVEQ	#0,D0
	MOVE.B	(A0)+,D0
	BEQ	NEXT_LIG
	CMP.B	#$FF,D0
	BEQ	FIN_MESS
	SUB.B	#' ',D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	TAB_FNT,A1
	MOVE.L	(A1,D0.W),A1
	MOVE.L	A1,A3
	SUB.L	#40*48,A3
	MOVE.L	A3,PEKADR1+2
PEKECR1
	MOVE.L	#ECRAN,A2
	MOVE.L	A2,PEKECR2+2
	MOVE.L	A2,PEKECR3+2
	MOVE.L	A2,PEKECR4+2
	MOVEQ	#15,D7
AFF_01
	MOVE.W	(A1),(A2)
	LEA	40(A1),A1
	LEA	160(A2),A2
	DBRA	D7,AFF_01
	ADDQ.L	#1,PEKM+2
	ADDQ.L	#8,PEKECR1+2
	RTS
NEXT_LIG
	MOVE.L	#ECRAN,PEKECR1+2
	ADDQ.L	#1,PEKM+2
	MOVE.L	#ROUT5A,SCROLL+2
*	BRA	ROUT1B
	RTS
FIN_MESS
	MOVE.L	#MESS,PEKM+2
	MOVE.L	#ECRAN,PEKECR1+2
	BRA	ROUT1
ROUT2
PEKADR1
	MOVE.L	#IMG+34,A0
	MOVE.L	A0,A3
	SUB.L	#40*48,A3
	MOVE.L	A3,PEKADR2+2
PEKECR2
	MOVE.L	#ECRAN,A1
	MOVEQ	#15,D7
AFF_02
	MOVE.W	(A0),(A1)
	LEA	40(A0),A0
	LEA	160(A1),A1
	DBRA	D7,AFF_02
	MOVE.L	#ROUT3,SCROLL+2
	RTS
ROUT3
PEKADR2
	MOVE.L	#IMG+34,A0
	MOVE.L	A0,A3
	SUB.L	#40*48,A3
	MOVE.L	A3,PEKADR3+2
PEKECR3
	MOVE.L	#ECRAN,A1
	MOVEQ	#15,D7
AFF_03
	MOVE.W	(A0),(A1)
	LEA	40(A0),A0
	LEA	160(A1),A1
	DBRA	D7,AFF_03
	MOVE.L	#ROUT4,SCROLL+2
	RTS
ROUT4
PEKADR3
	MOVE.L	#IMG+34,A0
	MOVE.L	A0,A3
PEKECR4
	MOVE.L	#ECRAN,A1
	MOVEQ	#15,D7
AFF_04
	MOVE.W	(A0),(A1)
	LEA	40(A0),A0
	LEA	160(A1),A1
	DBRA	D7,AFF_04
	MOVE.L	#ROUT1,SCROLL+2
	RTS
ROUT5A
	REPT	50
	MOVE.W	#$25,-(SP)
	TRAP	#$E
	ADDQ.L	#2,SP
	ENDR
	MOVE.L	#ROUT5,SCROLL+2
	RTS
ROUT5
	MOVE.L	PEKM+2,A0
	SUBQ.L	#2,A0
	MOVE.L	A0,PEKM2+2
	MOVE.L	#ECRAN+152,PEK_ADRMCS+2
ROUT5B
PEKM2
	MOVE.L	#MESS,A0
	MOVEQ	#0,D0
	MOVE.B	(A0),D0
	BEQ	ROUT9
	SUB.B	#' ',D0
	ADD.W	D0,D0
	ADD.W	D0,D0
	LEA	TAB_FNT,A1
	MOVE.L	(A1,D0.W),A1
	SUB.L	#40*48*2,A1
	MOVE.L	A1,A3
	ADD.L	#40*48,A3
	MOVE.L	A3,PEK_MAG1+2
PEK_ADRMCS
	MOVE.L	#ECRAN+152,A0
	MOVE.L	A0,PEK_MCS1+2
	MOVE.L	A0,PEK_MCS2+2
	MOVE.L	A0,PEK_MCS3+2
	MOVEQ	#15,D7
AFF_05
	MOVE.W	(A1),(A0)
	LEA	160(A0),A0
	LEA	40(A1),A1
	DBRA	D7,AFF_05
	MOVE.L	#ROUT6,SCROLL+2
	SUBQ.L	#1,PEKM2+2
	SUBQ.L	#8,PEK_ADRMCS+2
	RTS
ROUT6
PEK_MCS1
	MOVE.L	#ECRAN,A0
PEK_MAG1
	MOVE.L	#IMG+34,A1
	MOVE.L	A1,A3
	ADD.L	#40*48,A3
	MOVE.L	A3,PEK_MAG2+2
	MOVEQ	#15,D7
AFF_06
	MOVE.W	(A1),(A0)
	LEA	160(A0),A0
	LEA	40(A1),A1
	DBRA	D7,AFF_06
	MOVE.L	#ROUT7,SCROLL+2
	RTS
ROUT7
PEK_MCS2
	MOVE.L	#ECRAN,A0
PEK_MAG2
	MOVE.L	#IMG+34,A1
	MOVEQ	#15,D7
AFF_07
	MOVE.W	(A1),(A0)
	LEA	160(A0),A0
	LEA	40(A1),A1
	DBRA	D7,AFF_07
	MOVE.L	#ROUT8,SCROLL+2
	RTS
ROUT8
PEK_MCS3
	MOVE.L	#ECRAN,A0
	MOVEQ	#0,D0
	MOVEQ	#15,D7
AFF_08
	MOVE.L	D0,(A0)
	MOVE.L	D0,4(A0)
	LEA	160(A0),A0
	DBRA	D7,AFF_08
	MOVE.L	#ROUT5B,SCROLL+2
	RTS
ROUT9
	MOVE.L	#ROUT1,SCROLL+2
	RTS
OLD_PAL
	DS.W	16
IMG
	INCBIN	'FNTVEC.BIN'
FNT	EQU	IMG+40*48*3
SPACE	EQU	FNT+40*16*2+2*18
TAB_FNT 
	DC.L	SPACE
	DC.L	FNT+40*16+2*17
	DC.L	FNT+40*16*2+2*2
	DC.L	SPACE
	DC.L	SPACE
	DC.L	SPACE
	DC.L	SPACE
	DC.L	SPACE
	DC.L	FNT+40*16+2*18
	DC.L	FNT+40*16+2*19
	DC.L	SPACE
	DC.L	SPACE
	DC.L	FNT+40*16*2+2*4
	DC.L	SPACE
	DC.L	FNT+40*16*2
	DC.L	SPACE
	DC.L	FNT+40*16+2*6
	DC.L	FNT+40*16+2*7
	DC.L	FNT+40*16+2*8
	DC.L	FNT+40*16+2*9
	DC.L	FNT+40*16+2*10
	DC.L	FNT+40*16+2*11
	DC.L	FNT+40*16+2*12
	DC.L	FNT+40*16+2*13
	DC.L	FNT+40*16+2*14
	DC.L	FNT+40*16+2*15
	DC.L	FNT+40*16*2+2
	DC.L	FNT+40*16*2+2*3
	DC.L	SPACE
	DC.L	SPACE
	DC.L	SPACE
	DC.L	FNT+40*16+2*16
	DC.L	SPACE
M	SET	0
	REPT	20
	DC.L	FNT+M
M	SET	M+2
	ENDR
M	SET	0
	REPT	6
	DC.L	FNT+40*16+M
M	SET	M+2
	ENDR
	DC.B	0
MESS
	DC.B	'      YEAHH !!!!    ',0
	DC.B	'ONE NIGHT,ONE SCREEN',0
	DC.B	"AND IT'S (AS ALWAYS)",0
	DC.B	'CODED BY MAGNUM !!! ',0
	DC.B	"GFX BY THE LAZY ZORG",0,$FF
