ECRAN		EQU	$70000

	clr.l	-(sp)
	move.w	#32,-(sp)
	trap	#1
	addq.l	#6,sp
				
	MOVE.W	#$2700,SR

		MOVEQ	#1,D0
		JSR	ZIK

	CLR.B	$FFFF8260.W		
	MOVE.B	#$7,$FFFF8201.W
	MOVE.B	#$0,$FFFF8203.W

	MOVE.L	$70.W,OLD_70
	MOVE.L	#VBL,$70.W
	MOVE.W	#$2300,SR

		
		LEA	THRUD1+2,A0
		LEA	$FF8240,A1
		REPT	8
		MOVE.L	(A0)+,(A1)+
		ENDR

		LEA	CASSE,A0
		MOVE.L	#41547,D0
		MOVE.L	#128,D1
SIGNE		ADD.B	D1,(A0)+
		DBF	D0,SIGNE
		
		LEA	THRUD1+34,A0
ICI		BSR	AFF
		MOVE.W	#-1,D0
AZE		DBF	D0,AZE		
WAIT		CMP.B	#$39,$FFFC02
		BNE.S	WAIT
		ADD.W	#1,COMPT
		CMP.W	#1,COMPT
		BEQ.S	PALL2
		CMP.W	#2,COMPT
		BEQ.S	PALL3
		CMP.W	#3,COMPT
		BEQ.S	FIN
PALL2		LEA	THRUD2+34,A0
		BRA.S	ICI
PALL3		LEA	THRUD3+34,A0
		MOVE.W  #1+128,$FFFF8920.W 
	        LEA	$FFFF8901.W,A1
		MOVE.L	#CASSE,D0
		MOVEP.L	D0,(A1)
		MOVE.L	#ZIK,D0
		MOVEP.L	D0,12(A1)
		MOVE.W 	#1,$FFFF8900.W
		MOVE.L	#0,$4D2
		move.l #$8080000,$ffff8820.w		
		move.l #$9090000,$ffff8820.w		
		move.l #$a0a0000,$ffff8820.w
		BRA	ICI

VBL
	MOVE.W	#$2700,SR
	MOVE.B	#0,$FFFF8260.W
	JSR	ZIK+6
	MOVE.W	#$2300,SR
	RTE

FIN		
	MOVE.W	#$2700,SR
	MOVE.L	OLD_70,$70.W
	MOVE.B	#0,$FFFF8901.W
	move.l #$8080000,$ffff8820.w
	move.l #$9090000,$ffff8820.w
	move.l #$a0a0000,$ffff8820.w
	MOVE.W	#$0,$ff8240
		
	ILLEGAL
	
AFF		LEA	ECRAN,A1
		MOVE.L	#32000/4,D0
COPY		MOVE.L	(A0)+,(A1)+
		DBF	D0,COPY
		RTS
COMPT		DC.W	0
OLD_70	dc.w	0

THRUD1		INCBIN	THRUD1.PI1
THRUD2		INCBIN	THRUD2.PI1
THRUD3		INCBIN	THRUD3.PI1
CASSE		INCBIN	C_CASSE.SPL
		DC.L	0,0  
ZIK		INCBIN	CZ4.MUS
