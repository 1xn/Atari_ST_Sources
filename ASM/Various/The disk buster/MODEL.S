; song play routine by THE DISK BUSTER

BUFLEN1 EQU 36096
BUFLEN2 EQU 37376
BUFLEN3 EQU 36864
BUFLEN4 EQU 38912
BUFLEN5 EQU 35840
BUFLEN6 EQU 35840
BUFLEN7 EQU 51712
BUFLEN8 EQU 34816
BUFLEN9 EQU 34816
BUFLEN10 EQU 37888
BUFLEN11 EQU 35840
BUFLEN12 EQU 34816
; Init memory.
 MOVE.L A7,A5
 MOVE.L 4(A5),A5
 MOVE.L $C(A5),D0
 ADD.L $14(A5),D0
 ADD.L $1C(A5),D0
 ADD.L #$1100,D0
 MOVE.L A5,D1
 ADD.L D0,D1
 AND.L #-2,D1
 MOVE.L D1,A7
 MOVE.L D0,-(SP)
 MOVE.L A5,-(SP)
 MOVE.W D0,-(SP)
 MOVE.W #$4A,-(SP)
 TRAP #1
 ADD.L #12,SP

; Init graphics.
 DC.W $A000
 DC.W $A00A
 MOVE.W #4,-(SP)
 TRAP #14
 ADDQ.L #2,SP
 MOVE.W D0,-(SP)
 PEA -1
 PEA -1
 MOVE.W #5,-(SP)
 TRAP #14
 ADD.L #12,SP

; Reserve memory.
 MOVE.L #2757,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,PLAY

 MOVE.L #BUFLEN1,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER1
;
 MOVE.L #BUFLEN2,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER2
;
 MOVE.L #BUFLEN3,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER3
;
 MOVE.L #BUFLEN4,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER4
;
 MOVE.L #BUFLEN5,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER5
;
 MOVE.L #BUFLEN6,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER6
;
 MOVE.L #BUFLEN7,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER7
;
 MOVE.L #BUFLEN8,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER8
;
 MOVE.L #BUFLEN9,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER9
;
 MOVE.L #BUFLEN10,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER10
;
 MOVE.L #BUFLEN11,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER11
;
 MOVE.L #BUFLEN12,-(SP)
 MOVE.W #$48,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,BUFFER12
; Read files.
 CLR.W -(SP)
 MOVE.L #PLAY_FILE,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L PLAY,-(SP)
 MOVE.L #2757,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP

 CLR.W -(SP)
 MOVE.L #BUFFER_FILE1,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER1,-(SP)
 MOVE.L #BUFLEN1,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE2,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER2,-(SP)
 MOVE.L #BUFLEN2,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE3,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER3,-(SP)
 MOVE.L #BUFLEN3,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE4,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER4,-(SP)
 MOVE.L #BUFLEN4,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE5,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER5,-(SP)
 MOVE.L #BUFLEN5,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE5,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER5,-(SP)
 MOVE.L #BUFLEN5,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE6,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER6,-(SP)
 MOVE.L #BUFLEN6,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE7,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER7,-(SP)
 MOVE.L #BUFLEN7,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE8,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER8,-(SP)
 MOVE.L #BUFLEN8,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE9,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER9,-(SP)
 MOVE.L #BUFLEN9,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE10,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER10,-(SP)
 MOVE.L #BUFLEN10,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE11,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER11,-(SP)
 MOVE.L #BUFLEN11,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
;
 CLR.W -(SP)
 MOVE.L #BUFFER_FILE12,-(SP)
 MOVE.W #$3D,-(SP)
 TRAP #1
 ADDQ.L #8,SP
 MOVE.W D0,HANDLE
 MOVE.L BUFFER12,-(SP)
 MOVE.L #BUFLEN12,-(SP)
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3F,-(SP)
 TRAP #1
 ADD.L #12,SP
 MOVE.W HANDLE,-(SP)
 MOVE.W #$3E,-(SP)
 TRAP #1
 ADDQ.L #4,SP
; Output message.
 MOVE.L #MESSAGE,-(SP)
 MOVE.W #9,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.W #$007,-(SP)
 MOVE.W #0,-(SP)
 MOVE.W #7,-(SP)
 TRAP #14
 ADDQ.L #6,SP
 MOVE.W #$770,-(SP)
 MOVE.W #15,-(SP)
 MOVE.W #7,-(SP)
 TRAP #14
 ADDQ.L #6,SP
RESTART:
 MOVE.L #3,D5
MAIN:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER1,2(A0)
 MOVE.L #BUFLEN1,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
 DBRA D5,MAIN
;
MAIN2:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER2,2(A0)
 MOVE.L #BUFLEN2,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
 BSR MAIN3
 BRA MAIN4
;
MAIN3:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER3,2(A0)
 MOVE.L #BUFLEN3,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
 RTS
;
MAIN4:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER4,2(A0)
 MOVE.L #BUFLEN4,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT31:
 BSR MAIN3
;
MAIN5:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER5,2(A0)
 MOVE.L #BUFLEN5,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT32:
 BSR MAIN3
;
MAIN6:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER6,2(A0)
 MOVE.L #BUFLEN6,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT33:
 BSR MAIN3
 BSR MAIN7
 BSR MAIN7
 BRA MAIN8
;
MAIN7:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER7,2(A0)
 MOVE.L #BUFLEN7,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
 RTS
;
MAIN8:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER8,2(A0)
 MOVE.L #BUFLEN8,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT34:
 BSR MAIN3
;
MAIN9:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER9,2(A0)
 MOVE.L #BUFLEN9,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT35:
 BSR MAIN3
;
MAIN10:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER10,2(A0)
 MOVE.L #BUFLEN10,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT36:
 BSR MAIN3
;
MAIN11:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER11,2(A0)
 MOVE.L #BUFLEN11,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
;
REPEAT37:
 BSR MAIN3
REPAT71:
 BSR MAIN7
 BSR MAIN7
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR MAIN12
 BSR REPEAT72
 BRA RESTART
MAIN12:
 MOVE.L PLAY,A0
 ADD.L #28,A0
 MOVE.L BUFFER12,2(A0)
 MOVE.L #BUFLEN12,6(A0)
 MOVE.L #2,10(A0)
 JSR (A0)
 RTS
;
REPEAT72:
 BSR MAIN7
 BSR MAIN7
 RTS
;
 ALIGN
PLAY: DC.L 0
BUFFER1: DC.L 0
BUFFER2: DC.L 0
BUFFER3: DC.L 0
BUFFER4: DC.L 0
BUFFER5: DC.L 0
BUFFER6: DC.L 0
BUFFER7: DC.L 0
BUFFER8: DC.L 0
BUFFER9: DC.L 0
BUFFER10: DC.L 0
BUFFER11: DC.L 0
BUFFER12: DC.L 0
HANDLE: DC.W 0
PLAY_FILE: DC.B 'PLAY.DAT',0
BUFFER_FILE1: DC.B 'MODEL1.SPL',0
BUFFER_FILE2: DC.B 'MODEL2.SPL',0
BUFFER_FILE3: DC.B 'MODEL3.SPL',0
BUFFER_FILE4: DC.B 'MODEL4.SPL',0
BUFFER_FILE5: DC.B 'MODEL5.SPL',0
BUFFER_FILE6: DC.B 'MODEL6.SPL',0
BUFFER_FILE7: DC.B 'MODEL7.SPL',0
BUFFER_FILE8: DC.B 'MODEL8.SPL',0
BUFFER_FILE9: DC.B 'MODEL9.SPL',0
BUFFER_FILE10: DC.B 'MODEL10.SPL',0
BUFFER_FILE11: DC.B 'MODEL11.SPL',0
BUFFER_FILE12: DC.B 'MODEL12.SPL',0
 ALIGN
MESSAGE:
 DC.B 27,'Y',32+01,32+02,'**************************************'
 DC.B 27,'Y',32+02,32+02,'*       DIGITIZED SOUND DEMO         *'
 DC.B 27,'Y',32+03,32+02,'*      KRAFTVERKS "THE MODEL"        *'
 DC.B 27,'Y',32+04,32+02,'*      PROGRAM AND SAMPLING BY:      *'
 DC.B 27,'Y',32+05,32+02,'*          THE DISK BUSTER           *'
 DC.B 27,'Y',32+06,32+02,'*                AND                 *'
 DC.B 27,'Y',32+07,32+02,'*           THE ACCESS OF            *'
 DC.B 27,'Y',32+08,32+02,'*    THE MAGIC HACKERS OF SWEDEN     *'
 DC.B 27,'Y',32+09,32+02,'*           GREETINGS TO:            *'
 DC.B 27,'Y',32+10,32+02,'*     TEX,42 CREW,1001 CREW,CSS      *'
 DC.B 27,'Y',32+11,32+02,'*                                    *'
 DC.B 27,'Y',32+12,32+02,'*        TARIK IS A BAD ARAB         *'
 DC.B 27,'Y',32+13,32+02,'*                                    *'
 DC.B 27,'Y',32+14,32+02,'*                                    *'
 DC.B 27,'Y',32+15,32+02,'*      A HAPPY HI TO: BASTEN         *'
 DC.B 27,'Y',32+16,32+02,'**************************************',0
 END

 